{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":26175,"status":"ok","timestamp":1692719030740,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"_JZav8n575Qu","outputId":"fa59dacf-0fa0-459b-b7d7-26513db453c5"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ie5uLDH4uzAp"},"outputs":[],"source":["# clone YOLOv5 repository\n","%cd /content/drive/MyDrive/robocar/\n","!git clone https://github.com/ultralytics/yolov5  # clone repo\n","%cd yolov5\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7687,"status":"ok","timestamp":1692719043214,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"ens2oqLBCNRi","outputId":"a8217efc-9b23-4f54-a6a9-774d93902d67"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/559.7 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━\u001b[0m\u001b[91m╸\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.2/559.7 kB\u001b[0m \u001b[31m2.7 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m559.7/559.7 kB\u001b[0m \u001b[31m9.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/3.3 MB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m3.3/3.3 MB\u001b[0m \u001b[31m206.9 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.3/3.3 MB\u001b[0m \u001b[31m88.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m54.5/54.5 kB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m215.6/215.6 kB\u001b[0m \u001b[31m25.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m137.9/137.9 kB\u001b[0m \u001b[31m16.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m54.3/54.3 kB\u001b[0m \u001b[31m7.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m510.1/510.1 kB\u001b[0m \u001b[31m49.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}],"source":["!pip install -q comet_ml\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1692719043215,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"yaTwbtcoNJHZ","outputId":"1b710273-dbe2-4f80-f44b-cfd37e57295b"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/robocar/yolov5\n"]}],"source":["%cd /content/drive/MyDrive/robocar/yolov5/\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15747,"status":"ok","timestamp":1692719063836,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"wbvMlHd_QwMG","outputId":"310e9982-bc1e-4874-b817-4ca9ef5999ad"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m188.5/188.5 kB\u001b[0m \u001b[31m4.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m609.4/609.4 kB\u001b[0m \u001b[31m11.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.7/62.7 kB\u001b[0m \u001b[31m6.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hSetup complete. Using torch 2.0.1+cu118 _CudaDeviceProperties(name='NVIDIA A100-SXM4-40GB', major=8, minor=0, total_memory=40513MB, multi_processor_count=108)\n"]}],"source":["# install dependencies as necessary\n","!pip install -qr requirements.txt  # install dependencies (ignore errors)\n","import comet_ml\n","import torch\n","\n","from IPython.display import Image, clear_output  # to display images\n","from utils.downloads import attempt_download  # to download models/datasets\n","\n","# clear_output()\n","print('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LdjgO2RYCXGd"},"outputs":[],"source":["\n","from comet_ml import Experiment\n","\n","comet_ml.init(project_name=\"yolo\")\n"]},{"cell_type":"markdown","metadata":{"id":"UwJx-2NHsYxT"},"source":["# Define Model Configuration and Architecture\n","\n","We will write a yaml script that defines the parameters for our model like the number of classes, anchors, and each layer.\n","\n","You do not need to edit these cells, but you may."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MSBWvZ1gL2U-"},"outputs":[],"source":["!python train.py --weights runs/train/yolov5m8/weights/last.pt  --epochs 100  \\\n","--resume \"comet://trsanthosh/yolo-prod/2a3f3dcc0b4843a48a43f68768710760\""]},{"cell_type":"markdown","metadata":{"id":"WX-7ASyOlraz"},"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1NcFxRcFdJ_O","executionInfo":{"status":"ok","timestamp":1692731478233,"user_tz":-330,"elapsed":8141860,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"61cd8574-0721-4aeb-98e0-4ab0a6172502"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mtrain: \u001b[0mweights=yolov5m.pt, cfg=, data=./kitti.yaml, hyp=data/hyps/hyp.scratch-low.yaml, epochs=100, batch_size=16, imgsz=1248, rect=False, resume=False, nosave=False, noval=False, noautoanchor=False, noplots=False, evolve=None, bucket=, cache=ram, image_weights=False, device=, multi_scale=False, single_cls=False, optimizer=SGD, sync_bn=False, workers=8, project=runs/train, name=yolov5_medium, exist_ok=False, quad=False, cos_lr=False, label_smoothing=0.0, patience=100, freeze=[0], save_period=-1, seed=0, local_rank=-1, entity=None, upload_dataset=False, bbox_interval=-1, artifact_alias=latest\n","Command 'git fetch origin' timed out after 5 seconds\n","YOLOv5 🚀 v7.0-198-g34c2187 Python-3.10.12 torch-2.0.1+cu118 CUDA:0 (NVIDIA A100-SXM4-40GB, 40514MiB)\n","\n","\u001b[34m\u001b[1mhyperparameters: \u001b[0mlr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0\n","\u001b[34m\u001b[1mTensorBoard: \u001b[0mStart with 'tensorboard --logdir runs/train', view at http://localhost:6006/\n","\u001b[1;38;5;214mCOMET WARNING:\u001b[0m You are trying to log string value as a metric. This is not recommended.\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m Experiment is live on comet.com \u001b[38;5;39mhttps://www.comet.com/trsanthosh/yolo/7f8fd2a9b29549d3849125421c358ebe\u001b[0m\n","\n","Downloading https://ultralytics.com/assets/Arial.ttf to /root/.config/Ultralytics/Arial.ttf...\n","100%|██████████| 755k/755k [00:00<00:00, 151MB/s]\n","Overriding model.yaml nc=80 with nc=7\n","\n","                 from  n    params  module                                  arguments                     \n","  0                -1  1      5280  models.common.Conv                      [3, 48, 6, 2, 2]              \n","  1                -1  1     41664  models.common.Conv                      [48, 96, 3, 2]                \n","  2                -1  2     65280  models.common.C3                        [96, 96, 2]                   \n","  3                -1  1    166272  models.common.Conv                      [96, 192, 3, 2]               \n","  4                -1  4    444672  models.common.C3                        [192, 192, 4]                 \n","  5                -1  1    664320  models.common.Conv                      [192, 384, 3, 2]              \n","  6                -1  6   2512896  models.common.C3                        [384, 384, 6]                 \n","  7                -1  1   2655744  models.common.Conv                      [384, 768, 3, 2]              \n","  8                -1  2   4134912  models.common.C3                        [768, 768, 2]                 \n","  9                -1  1   1476864  models.common.SPPF                      [768, 768, 5]                 \n"," 10                -1  1    295680  models.common.Conv                      [768, 384, 1, 1]              \n"," 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 12           [-1, 6]  1         0  models.common.Concat                    [1]                           \n"," 13                -1  2   1182720  models.common.C3                        [768, 384, 2, False]          \n"," 14                -1  1     74112  models.common.Conv                      [384, 192, 1, 1]              \n"," 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 16           [-1, 4]  1         0  models.common.Concat                    [1]                           \n"," 17                -1  2    296448  models.common.C3                        [384, 192, 2, False]          \n"," 18                -1  1    332160  models.common.Conv                      [192, 192, 3, 2]              \n"," 19          [-1, 14]  1         0  models.common.Concat                    [1]                           \n"," 20                -1  2   1035264  models.common.C3                        [384, 384, 2, False]          \n"," 21                -1  1   1327872  models.common.Conv                      [384, 384, 3, 2]              \n"," 22          [-1, 10]  1         0  models.common.Concat                    [1]                           \n"," 23                -1  2   4134912  models.common.C3                        [768, 768, 2, False]          \n"," 24      [17, 20, 23]  1     48492  models.yolo.Detect                      [7, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [192, 384, 768]]\n","Model summary: 291 layers, 20895564 parameters, 20895564 gradients, 48.3 GFLOPs\n","\n","Transferred 475/481 items from yolov5m.pt\n","\u001b[34m\u001b[1mAMP: \u001b[0mchecks passed ✅\n","\u001b[34m\u001b[1moptimizer:\u001b[0m SGD(lr=0.01) with parameter groups 79 weight(decay=0.0), 82 weight(decay=0.0005), 82 bias\n","\u001b[34m\u001b[1malbumentations: \u001b[0mBlur(p=0.01, blur_limit=(3, 7)), MedianBlur(p=0.01, blur_limit=(3, 7)), ToGray(p=0.01), CLAHE(p=0.01, clip_limit=(1, 4.0), tile_grid_size=(8, 8))\n","\u001b[34m\u001b[1mtrain: \u001b[0mScanning /content/drive/MyDrive/robocar/dataset/kitti/train/labels... 5237 images, 11 backgrounds, 0 corrupt: 100%|██████████| 5237/5237 [10:23<00:00,  8.40it/s]\n","\u001b[34m\u001b[1mtrain: \u001b[0mNew cache created: /content/drive/MyDrive/robocar/dataset/kitti/train/labels.cache\n","\u001b[34m\u001b[1mtrain: \u001b[0mCaching images (6.9GB ram): 100%|██████████| 5237/5237 [09:47<00:00,  8.92it/s]\n","\u001b[34m\u001b[1mval: \u001b[0mScanning /content/drive/MyDrive/robocar/dataset/kitti/val/labels.cache... 1122 images, 2 backgrounds, 0 corrupt: 100%|██████████| 1122/1122 [00:00<?, ?it/s]\n","\u001b[34m\u001b[1mval: \u001b[0mCaching images (1.5GB ram): 100%|██████████| 1122/1122 [00:17<00:00, 65.52it/s]\n","\n","\u001b[34m\u001b[1mAutoAnchor: \u001b[0m5.12 anchors/target, 1.000 Best Possible Recall (BPR). Current anchors are a good fit to dataset ✅\n","Plotting labels to runs/train/yolov5_medium2/labels.jpg... \n","Image sizes 1248 train, 1248 val\n","Using 8 dataloader workers\n","Logging results to \u001b[1mruns/train/yolov5_medium2\u001b[0m\n","Starting training for 100 epochs...\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       0/99      23.4G    0.06878    0.06503    0.02995         54       1248: 100%|██████████| 328/328 [01:50<00:00,  2.97it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:21<00:00,  1.69it/s]\n","                   all       1122       6112      0.163      0.361      0.226      0.106\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       1/99      23.4G    0.05547    0.04895    0.01742         54       1248: 100%|██████████| 328/328 [01:40<00:00,  3.26it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:17<00:00,  2.02it/s]\n","                   all       1122       6112      0.488      0.517      0.434      0.234\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       2/99      23.4G    0.04925    0.04634    0.01367         39       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.626      0.591      0.545      0.298\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       3/99      23.4G    0.04332    0.04541    0.01065        112       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.773       0.72      0.758      0.448\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       4/99      23.4G    0.03851    0.04262   0.008367         40       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.809      0.745      0.819      0.483\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       5/99      23.4G     0.0363    0.04199   0.006603         62       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.856      0.814      0.878      0.525\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       6/99      23.4G    0.03464    0.04117   0.005771         64       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.15it/s]\n","                   all       1122       6112      0.895       0.83      0.904      0.583\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       7/99      23.4G    0.03344     0.0399   0.005146         71       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112      0.877      0.857      0.915      0.592\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       8/99      23.4G    0.03254    0.03917   0.004651         71       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.887      0.837      0.913      0.613\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       9/99      23.4G    0.03156    0.03869   0.004386         62       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.901      0.869      0.925      0.627\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      10/99      23.4G    0.03092    0.03809   0.004239         51       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112       0.91      0.862      0.926      0.626\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      11/99      23.4G    0.03028    0.03788   0.003933         34       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.12it/s]\n","                   all       1122       6112      0.907      0.886      0.934       0.63\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      12/99      23.4G    0.02975    0.03701   0.003674         51       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.928      0.875      0.939      0.657\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      13/99      23.4G    0.02879    0.03633   0.003513         61       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.09it/s]\n","                   all       1122       6112       0.92      0.893      0.933       0.66\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      14/99      23.4G     0.0286    0.03605   0.003374         35       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.916      0.897       0.94      0.673\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      15/99      23.4G    0.02791    0.03562   0.003401         50       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.914      0.895      0.946      0.659\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      16/99      23.4G    0.02768    0.03481   0.003173         78       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.926      0.903      0.943      0.673\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      17/99      23.4G    0.02718    0.03458   0.003091         58       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.929      0.904      0.948      0.688\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      18/99      23.4G     0.0266    0.03423    0.00294         79       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.918      0.885       0.94      0.677\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      19/99      23.4G    0.02645    0.03395   0.002887         57       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.26it/s]\n","                   all       1122       6112      0.938      0.908      0.952      0.698\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      20/99      23.4G    0.02568    0.03346   0.002739         82       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.28it/s]\n","                   all       1122       6112      0.933      0.911      0.956      0.704\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      21/99      23.4G    0.02567    0.03316   0.002698         25       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.933      0.911      0.952      0.707\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      22/99      23.4G    0.02509    0.03258   0.002559         61       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.941      0.892      0.948      0.709\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      23/99      23.4G    0.02519    0.03204   0.002658         71       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112       0.93      0.915      0.947      0.707\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      24/99      23.4G    0.02477     0.0318   0.002526         36       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.931      0.907       0.95      0.718\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      25/99      23.4G    0.02462    0.03174   0.002469         59       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.936      0.906      0.955      0.723\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      26/99      23.4G    0.02433    0.03185   0.002395         62       1248: 100%|██████████| 328/328 [01:39<00:00,  3.29it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.28it/s]\n","                   all       1122       6112      0.945       0.91      0.953      0.725\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      27/99      23.4G    0.02401    0.03087   0.002416         44       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112       0.94      0.917      0.958      0.724\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      28/99      23.4G    0.02352    0.03104   0.002236         40       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.945      0.913      0.951      0.723\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      29/99      23.4G     0.0233    0.03028   0.002279         37       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.20it/s]\n","                   all       1122       6112      0.941      0.914      0.958      0.728\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      30/99      23.4G    0.02326    0.03081   0.002214         27       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.943      0.912      0.955      0.729\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      31/99      23.4G    0.02303    0.02989   0.002204         62       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112       0.94      0.918      0.954      0.734\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      32/99      23.4G    0.02275    0.03012   0.002105         51       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.949      0.907      0.958      0.737\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      33/99      23.4G     0.0226    0.02952   0.002098         93       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.943      0.916      0.955      0.726\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      34/99      23.4G    0.02248    0.02967   0.002092         45       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.943      0.926      0.958      0.741\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      35/99      23.4G    0.02216    0.02927   0.002032         24       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.942      0.924      0.959      0.741\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      36/99      23.4G    0.02192     0.0287   0.001988         56       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.20it/s]\n","                   all       1122       6112      0.946      0.923      0.956      0.739\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      37/99      23.4G    0.02183    0.02923   0.001963         91       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.945      0.904      0.955       0.74\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      38/99      23.4G    0.02171    0.02844   0.001925         86       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.952      0.916      0.958      0.749\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      39/99      23.4G    0.02153    0.02841   0.001837         51       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.944      0.919      0.955       0.75\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      40/99      23.4G    0.02126    0.02778   0.001861         31       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.936      0.919       0.96      0.751\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      41/99      23.4G    0.02126    0.02827   0.001932         57       1248: 100%|██████████| 328/328 [01:39<00:00,  3.29it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112       0.94      0.925      0.958      0.752\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      42/99      23.4G      0.021    0.02799    0.00189         50       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.16it/s]\n","                   all       1122       6112      0.944      0.921      0.957      0.749\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      43/99      23.4G     0.0209    0.02749   0.001778         42       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.949      0.919      0.955      0.752\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      44/99      23.4G    0.02084    0.02802   0.001806         64       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112      0.948      0.927      0.958      0.755\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      45/99      23.4G    0.02042    0.02731   0.001745         65       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.17it/s]\n","                   all       1122       6112      0.949      0.921      0.959      0.754\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      46/99      23.4G     0.0204     0.0273   0.001713         52       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112       0.95      0.919       0.96      0.761\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      47/99      23.4G    0.02022    0.02686   0.001762         83       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.945      0.927      0.959      0.762\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      48/99      23.4G    0.01998    0.02674   0.001657         47       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.947      0.928       0.96      0.761\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      49/99      23.4G    0.02008    0.02689   0.001744         43       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.29it/s]\n","                   all       1122       6112       0.95      0.928       0.96      0.763\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      50/99      23.4G    0.01989    0.02631   0.001648         34       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.956      0.915       0.96      0.769\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      51/99      23.4G    0.01963    0.02578   0.001696         46       1248: 100%|██████████| 328/328 [01:39<00:00,  3.29it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.952      0.931      0.961      0.763\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      52/99      23.4G    0.01957     0.0258   0.001646         52       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.938      0.925      0.959      0.765\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      53/99      23.4G    0.01933    0.02612   0.001608         41       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.19it/s]\n","                   all       1122       6112       0.95      0.933      0.962      0.767\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      54/99      23.4G     0.0193    0.02597   0.001595         59       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.954      0.925      0.963      0.768\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      55/99      23.4G    0.01902    0.02557   0.001538         79       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.959      0.932      0.963      0.772\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      56/99      23.4G    0.01907    0.02511   0.001606         50       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.954      0.929       0.96      0.769\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      57/99      23.4G    0.01909    0.02525   0.001546         60       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.18it/s]\n","                   all       1122       6112      0.956      0.936      0.963      0.775\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      58/99      23.4G    0.01871    0.02522   0.001539         39       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.26it/s]\n","                   all       1122       6112      0.961      0.922      0.962      0.778\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      59/99      23.4G    0.01869    0.02508   0.001505         33       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112      0.962      0.925      0.962      0.778\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      60/99      23.4G    0.01867    0.02491   0.001561         50       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.956      0.927      0.963      0.775\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      61/99      23.4G    0.01835    0.02434   0.001462         36       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.956      0.924      0.962      0.776\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      62/99      23.4G    0.01837    0.02466   0.001542         54       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.11it/s]\n","                   all       1122       6112      0.955      0.936      0.965      0.779\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      63/99      23.4G    0.01806    0.02416   0.001421         54       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.949      0.927      0.962      0.778\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      64/99      23.4G    0.01796    0.02426   0.001402         68       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.954      0.929      0.959      0.781\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      65/99      23.4G    0.01776    0.02391   0.001392         79       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.17it/s]\n","                   all       1122       6112      0.958      0.933      0.963      0.785\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      66/99      23.4G    0.01785    0.02381   0.001401         33       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.18it/s]\n","                   all       1122       6112      0.958       0.93      0.962      0.784\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      67/99      23.4G     0.0178    0.02399   0.001394         69       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.13it/s]\n","                   all       1122       6112      0.955      0.937      0.962      0.787\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      68/99      23.4G    0.01751    0.02332   0.001374         84       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.953      0.935      0.964      0.787\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      69/99      23.4G    0.01746    0.02341   0.001357         25       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.966      0.929      0.964      0.785\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      70/99      23.4G    0.01724    0.02311   0.001345         65       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.962      0.932      0.965      0.787\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      71/99      23.4G    0.01713    0.02282   0.001323         51       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.956      0.931      0.963      0.783\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      72/99      23.4G    0.01701    0.02294   0.001307         76       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112       0.96       0.93      0.964      0.788\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      73/99      23.4G    0.01691    0.02302   0.001301         49       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.961      0.928      0.963      0.789\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      74/99      23.4G    0.01692    0.02324   0.001274         74       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.21it/s]\n","                   all       1122       6112      0.954      0.934      0.964      0.786\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      75/99      23.4G    0.01672    0.02205   0.001237         69       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.953      0.933      0.964      0.789\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      76/99      23.4G    0.01659    0.02212   0.001222         49       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.953      0.928      0.964      0.791\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      77/99      23.4G    0.01656    0.02225   0.001268         63       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112       0.96      0.931      0.965      0.792\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      78/99      23.4G    0.01637    0.02202   0.001267         68       1248: 100%|██████████| 328/328 [01:39<00:00,  3.29it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.11it/s]\n","                   all       1122       6112      0.958      0.929      0.964      0.793\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      79/99      23.4G    0.01625     0.0218   0.001161         59       1248: 100%|██████████| 328/328 [01:39<00:00,  3.29it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.06it/s]\n","                   all       1122       6112      0.958      0.936      0.965      0.797\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      80/99      23.4G    0.01624    0.02197   0.001224         27       1248: 100%|██████████| 328/328 [01:40<00:00,  3.28it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.03it/s]\n","                   all       1122       6112      0.951      0.934      0.964      0.796\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      81/99      23.4G     0.0161    0.02163    0.00122         96       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.10it/s]\n","                   all       1122       6112      0.953      0.933      0.963      0.795\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      82/99      23.4G    0.01597    0.02137   0.001193         47       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.14it/s]\n","                   all       1122       6112      0.952      0.937      0.965      0.797\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      83/99      23.4G    0.01597    0.02168   0.001167         94       1248: 100%|██████████| 328/328 [01:39<00:00,  3.28it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.09it/s]\n","                   all       1122       6112      0.955      0.942      0.965      0.799\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      84/99      23.4G    0.01592    0.02127   0.001124         48       1248: 100%|██████████| 328/328 [01:39<00:00,  3.28it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.11it/s]\n","                   all       1122       6112       0.96      0.934      0.966      0.799\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      85/99      23.4G    0.01582    0.02102    0.00118         63       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.961      0.936      0.966      0.801\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      86/99      23.4G    0.01563    0.02094   0.001129         55       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.954      0.934      0.965      0.799\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      87/99      23.4G    0.01545    0.02078   0.001111         80       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.20it/s]\n","                   all       1122       6112      0.957       0.93      0.965      0.799\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      88/99      23.4G    0.01547    0.02034   0.001106         75       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.25it/s]\n","                   all       1122       6112      0.951      0.934      0.965      0.798\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      89/99      23.4G    0.01541    0.02064   0.001133         71       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.22it/s]\n","                   all       1122       6112      0.952      0.932      0.966        0.8\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      90/99      23.4G    0.01524    0.02047   0.001122         36       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.958      0.928      0.966        0.8\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      91/99      23.4G    0.01526    0.02045   0.001124         33       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.10it/s]\n","                   all       1122       6112      0.955       0.93      0.967      0.801\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      92/99      23.4G    0.01506    0.02015   0.001072         47       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.27it/s]\n","                   all       1122       6112      0.959      0.928      0.966      0.801\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      93/99      23.4G    0.01506    0.01968   0.001171         68       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.23it/s]\n","                   all       1122       6112      0.957      0.932      0.966      0.805\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      94/99      23.4G    0.01494    0.01979   0.001039         33       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.959      0.928      0.967      0.805\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      95/99      23.4G     0.0149    0.01952   0.001033         59       1248: 100%|██████████| 328/328 [01:39<00:00,  3.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.15it/s]\n","                   all       1122       6112      0.959      0.931      0.967      0.806\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      96/99      23.4G    0.01484    0.01928   0.001058         48       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.963      0.928      0.966      0.805\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      97/99      23.4G    0.01483    0.01937   0.001048         57       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.26it/s]\n","                   all       1122       6112       0.96      0.927      0.966      0.804\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      98/99      23.4G    0.01491    0.01936   0.001099         47       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.26it/s]\n","                   all       1122       6112      0.959      0.928      0.965      0.805\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      99/99      23.4G    0.01465    0.01946    0.00105         31       1248: 100%|██████████| 328/328 [01:39<00:00,  3.30it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:08<00:00,  4.24it/s]\n","                   all       1122       6112      0.956      0.929      0.966      0.806\n","\n","100 epochs completed in 3.039 hours.\n","Optimizer stripped from runs/train/yolov5_medium2/weights/last.pt, 42.3MB\n","Optimizer stripped from runs/train/yolov5_medium2/weights/best.pt, 42.3MB\n","\n","Validating runs/train/yolov5_medium2/weights/best.pt...\n","Fusing layers... \n","Model summary: 212 layers, 20877180 parameters, 0 gradients, 47.9 GFLOPs\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 36/36 [00:14<00:00,  2.56it/s]\n","                   all       1122       6112      0.959      0.931      0.967      0.806\n","                   Car       1122       4319      0.964      0.954      0.979      0.876\n","                   Van       1122        451      0.966      0.945      0.974       0.86\n","                 Truck       1122        161      0.983      0.981      0.994      0.891\n","            Pedestrian       1122        724      0.946       0.85      0.921      0.607\n","               Cyclist       1122        250      0.927      0.919      0.937      0.741\n","                  Tram       1122         65      0.968      0.921      0.988      0.839\n","                  Misc       1122        142      0.957      0.948      0.973      0.828\n","Results saved to \u001b[1mruns/train/yolov5_medium2\u001b[0m\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m ---------------------------------------------------------------------------------------\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m Comet.ml Experiment Summary\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m ---------------------------------------------------------------------------------------\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m   Data:\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     display_summary_level : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     url                   : \u001b[38;5;39mhttps://www.comet.com/trsanthosh/yolo/7f8fd2a9b29549d3849125421c358ebe\u001b[0m\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m   Metrics [count] (min, max):\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     loss [3270]                : (0.3687354326248169, 4.860646724700928)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     metrics/mAP_0.5 [200]      : (0.22626246494350458, 0.9666650104550836)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     metrics/mAP_0.5:0.95 [200] : (0.10562001947817543, 0.8057327408508765)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     metrics/precision [200]    : (0.16305618599454477, 0.9662754427224686)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     metrics/recall [200]       : (0.3605516961706143, 0.9416778938534874)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     train/box_loss [200]       : (0.014653852209448814, 0.06877691298723221)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     train/cls_loss [200]       : (0.001033339649438858, 0.029951635748147964)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     train/obj_loss [200]       : (0.019283702597022057, 0.06502889096736908)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     val/box_loss [200]         : (0.017664484679698944, 0.05247858166694641)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     val/cls_loss [200]         : (0.0015477832639589906, 0.02041027322411537)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     val/obj_loss [200]         : (0.047064945101737976, 0.07616134732961655)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     x/lr0 [200]                : (0.0002980000000000002, 0.07009146341463415)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     x/lr1 [200]                : (0.0002980000000000002, 0.00979203861788618)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     x/lr2 [200]                : (0.0002980000000000002, 0.00979203861788618)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m   Others:\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     Name                        : yolov5_medium\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     Run Path                    : trsanthosh/yolo/7f8fd2a9b29549d3849125421c358ebe\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_log_batch_metrics     : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_log_confusion_matrix  : True\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_log_per_class_metrics : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_max_image_uploads     : 100\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_mode                  : online\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     comet_model_name            : yolov5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hasNestedParams             : True\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m   Parameters:\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     anchor_t            : 4.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     artifact_alias      : latest\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     batch_size          : 16\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     bbox_interval       : -1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     box                 : 0.05\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     bucket              : \n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     cfg                 : \n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     cls                 : 0.04374999999999999\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     cls_pw              : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     copy_paste          : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     cos_lr              : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     degrees             : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     device              : \n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     entity              : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     evolve              : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     exist_ok            : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     fl_gamma            : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     fliplr              : 0.5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     flipud              : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     freeze              : [0]\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hsv_h               : 0.015\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hsv_s               : 0.7\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hsv_v               : 0.4\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|anchor_t        : 4.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|box             : 0.05\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|cls             : 0.5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|cls_pw          : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|copy_paste      : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|degrees         : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|fl_gamma        : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|fliplr          : 0.5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|flipud          : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|hsv_h           : 0.015\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|hsv_s           : 0.7\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|hsv_v           : 0.4\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|iou_t           : 0.2\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|lr0             : 0.01\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|lrf             : 0.01\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|mixup           : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|momentum        : 0.937\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|mosaic          : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|obj             : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|obj_pw          : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|perspective     : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|scale           : 0.5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|shear           : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|translate       : 0.1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|warmup_bias_lr  : 0.1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|warmup_epochs   : 3.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|warmup_momentum : 0.8\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     hyp|weight_decay    : 0.0005\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     image_weights       : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     imgsz               : 1248\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     iou_t               : 0.2\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     label_smoothing     : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     local_rank          : -1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     lr0                 : 0.01\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     lrf                 : 0.01\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     mixup               : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     momentum            : 0.937\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     mosaic              : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     multi_scale         : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     noautoanchor        : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     noplots             : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     nosave              : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     noval               : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     obj                 : 3.8024999999999998\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     obj_pw              : 1.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     optimizer           : SGD\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     patience            : 100\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     perspective         : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     project             : runs/train\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     quad                : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     rect                : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     resume              : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     save_dir            : runs/train/yolov5_medium2\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     save_period         : -1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     scale               : 0.5\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     seed                : 0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     shear               : 0.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     single_cls          : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     sync_bn             : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     translate           : 0.1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     upload_dataset      : False\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     val_conf_threshold  : 0.001\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     val_iou_threshold   : 0.6\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     warmup_bias_lr      : 0.1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     warmup_epochs       : 3.0\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     warmup_momentum     : 0.8\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     weight_decay        : 0.0005\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     workers             : 8\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m   Uploads:\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     asset               : 13 (1.51 MB)\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     confusion-matrix    : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     environment details : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     git metadata        : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     images              : 106\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     installed packages  : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     model graph         : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m     os packages         : 1\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m \n","\u001b[36m────────────────────────────── \u001b[0m\u001b[1;36mNew Comet feature!\u001b[0m\u001b[36m ──────────────────────────────\u001b[0m\n","Log your models to better track, deploy, share, and reproduce your work using: 'comet_ml.integration.pytorch.log_model'.\n","Learn more at: https://comet.com/docs/v2/pytorch_log_model\n","\n","Hide this message by setting environment variable \"COMET_DISABLE_ANNOUNCEMENT=1\" \n","\u001b[36m────────────────────────────────────────────────────────────────────────────────\u001b[0m\n","\u001b[1;38;5;39mCOMET INFO:\u001b[0m Please wait for metadata to finish uploading (timeout is 3600 seconds)\n","CPU times: user 1min 49s, sys: 16 s, total: 2min 5s\n","Wall time: 3h 26min 46s\n"]}],"source":["# train yolov5s on custom data for 100 epochs\n","# time its performance\n","%%time\n","!python train.py --img 1248 --batch 16 --epochs 100 --data ./kitti.yaml \\\n","--weights yolov5m.pt  --name yolov5_medium \\\n","--cache ram\n","#--save-period 1  \\\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":25646,"status":"ok","timestamp":1692731523758,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"Y3rYtGzSVCzu","outputId":"e72fd7f1-273c-4f26-ece3-d42f1c5ee09d"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mval: \u001b[0mdata=./kitti.yaml, weights=['runs/train/yolov5_medium2/weights/best.pt'], batch_size=16, imgsz=1248, conf_thres=0.001, iou_thres=0.6, max_det=300, task=val, device=, workers=8, single_cls=False, augment=False, verbose=False, save_txt=False, save_hybrid=False, save_conf=False, save_json=False, project=runs/val, name=exp, exist_ok=False, half=False, dnn=False\n","YOLOv5 🚀 v7.0-198-g34c2187 Python-3.10.12 torch-2.0.1+cu118 CUDA:0 (NVIDIA A100-SXM4-40GB, 40514MiB)\n","\n","Fusing layers... \n","Model summary: 212 layers, 20877180 parameters, 0 gradients, 47.9 GFLOPs\n","\u001b[34m\u001b[1mval: \u001b[0mScanning /content/drive/MyDrive/robocar/dataset/kitti/val/labels.cache... 1122 images, 2 backgrounds, 0 corrupt: 100% 1122/1122 [00:00<?, ?it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 71/71 [00:15<00:00,  4.73it/s]\n","                   all       1122       6112      0.959      0.931      0.967      0.806\n","                   Car       1122       4319      0.965      0.954       0.98      0.877\n","                   Van       1122        451      0.966      0.945      0.974      0.861\n","                 Truck       1122        161      0.983      0.981      0.994      0.892\n","            Pedestrian       1122        724      0.946       0.85      0.922      0.607\n","               Cyclist       1122        250      0.927      0.918      0.936      0.741\n","                  Tram       1122         65      0.968      0.921      0.988      0.841\n","                  Misc       1122        142      0.957      0.948      0.973      0.825\n","Speed: 0.2ms pre-process, 2.4ms inference, 2.0ms NMS per image at shape (16, 3, 1248, 1248)\n","Results saved to \u001b[1mruns/val/exp11\u001b[0m\n"]}],"source":["!python val.py --weights runs/train/yolov5_medium2/weights/best.pt --data ./kitti.yaml  --img 1248 --task val --batch 16 # --half"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":157481,"status":"ok","timestamp":1692731681231,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"},"user_tz":-330},"id":"58qHzALIVDnx","outputId":"80528b16-0e3a-430f-df8e-415289cafde6"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mval: \u001b[0mdata=./kitti.yaml, weights=['runs/train/yolov5_medium2/weights/best.pt'], batch_size=16, imgsz=1248, conf_thres=0.001, iou_thres=0.6, max_det=300, task=test, device=, workers=8, single_cls=False, augment=False, verbose=False, save_txt=False, save_hybrid=False, save_conf=False, save_json=False, project=runs/val, name=exp, exist_ok=False, half=False, dnn=False\n","YOLOv5 🚀 v7.0-198-g34c2187 Python-3.10.12 torch-2.0.1+cu118 CUDA:0 (NVIDIA A100-SXM4-40GB, 40514MiB)\n","\n","Fusing layers... \n","Model summary: 212 layers, 20877180 parameters, 0 gradients, 47.9 GFLOPs\n","\u001b[34m\u001b[1mtest: \u001b[0mScanning /content/drive/MyDrive/robocar/dataset/kitti/test/labels... 1122 images, 0 backgrounds, 0 corrupt: 100% 1122/1122 [02:01<00:00,  9.22it/s]\n","\u001b[34m\u001b[1mtest: \u001b[0mNew cache created: /content/drive/MyDrive/robocar/dataset/kitti/test/labels.cache\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 71/71 [00:14<00:00,  4.85it/s]\n","                   all       1122       6075      0.967      0.931      0.963      0.803\n","                   Car       1122       4297      0.976      0.947      0.981      0.879\n","                   Van       1122        429      0.976      0.956      0.977       0.86\n","                 Truck       1122        174      0.971      0.989      0.985      0.884\n","            Pedestrian       1122        694      0.949      0.839      0.907      0.592\n","               Cyclist       1122        255      0.965      0.906      0.944      0.755\n","                  Tram       1122         66      0.967      0.955      0.975      0.828\n","                  Misc       1122        160      0.966      0.925      0.974      0.828\n","Speed: 0.2ms pre-process, 2.4ms inference, 1.1ms NMS per image at shape (16, 3, 1248, 1248)\n","Results saved to \u001b[1mruns/val/exp12\u001b[0m\n"]}],"source":["!python val.py --weights  runs/train/yolov5_medium2/weights/best.pt  --data ./kitti.yaml  --img 1248 --task test --batch 16\n"]},{"cell_type":"markdown","metadata":{"id":"kJVs_4zEeVbF"},"source":["# Evaluate Custom YOLOv5 Detector Performance"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qxZyHEm4UrW2","executionInfo":{"status":"ok","timestamp":1692891253975,"user_tz":-330,"elapsed":22891,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"8ed2af6a-57b0-4e89-bd07-934a442fe127"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["%pip install -q ultralytics\n","%cd /content/drive/MyDrive/robocar/yolov5"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D-wr052XUro3","executionInfo":{"status":"ok","timestamp":1692891258943,"user_tz":-330,"elapsed":4976,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"7bfa0677-1c53-4871-8cf9-ff0c5f0b3aa6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/609.5 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━━━━\u001b[0m\u001b[90m╺\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m61.4/609.5 kB\u001b[0m \u001b[31m2.2 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m604.2/609.5 kB\u001b[0m \u001b[31m9.9 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m609.5/609.5 kB\u001b[0m \u001b[31m8.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h/content/drive/MyDrive/robocar/yolov5\n"]}]},{"cell_type":"code","source":["import os\n","from PIL import Image\n","\n","# Image\n","image_folder = '../dataset/kitti/test/images'\n","# Get a list of all the image files in the folder\n","\n","%time\n","image_files = [os.path.join(image_folder, image) for image in os.listdir(image_folder)]\n","\n","images=[]\n","\n","for image_file in image_files:\n","  # Load the image from file\n","  image = Image.open(image_file)\n","  images.append(image)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JFakXZREUrsX","executionInfo":{"status":"ok","timestamp":1692891291408,"user_tz":-330,"elapsed":32472,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"9800d25e-353f-48f7-cd23-188e256c7dd3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 1 µs, sys: 1 µs, total: 2 µs\n","Wall time: 4.77 µs\n"]}]},{"cell_type":"code","source":["import torch\n","import time\n","\n","weights_path = 'runs/train/yolov5_medium2/weights/best.pt'\n","\n","model = torch.hub.load('.', 'custom', path=weights_path, source='local')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DJOyWlSXU6Pu","executionInfo":{"status":"ok","timestamp":1692891351294,"user_tz":-330,"elapsed":59893,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"edb27ab4-087d-41c6-9fbd-1ced331e1f68"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["\u001b[31m\u001b[1mrequirements:\u001b[0m Ultralytics requirement ['gitpython>=3.1.30'] not found, attempting AutoUpdate...\n","Collecting gitpython>=3.1.30\n","  Downloading GitPython-3.1.32-py3-none-any.whl (188 kB)\n","     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.5/188.5 kB 3.5 MB/s eta 0:00:00\n","Collecting gitdb<5,>=4.0.1 (from gitpython>=3.1.30)\n","  Downloading gitdb-4.0.10-py3-none-any.whl (62 kB)\n","     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.7/62.7 kB 237.5 MB/s eta 0:00:00\n","Collecting smmap<6,>=3.0.1 (from gitdb<5,>=4.0.1->gitpython>=3.1.30)\n","  Downloading smmap-5.0.0-py3-none-any.whl (24 kB)\n","Installing collected packages: smmap, gitdb, gitpython\n","Successfully installed gitdb-4.0.10 gitpython-3.1.32 smmap-5.0.0\n","\n","\u001b[31m\u001b[1mrequirements:\u001b[0m AutoUpdate success ✅ 4.3s, installed 1 package: ['gitpython>=3.1.30']\n","\u001b[31m\u001b[1mrequirements:\u001b[0m ⚠️ \u001b[1mRestart runtime or rerun command for updates to take effect\u001b[0m\n","\n","YOLOv5 🚀 v7.0-198-g34c2187 Python-3.10.12 torch-2.0.1+cu118 CUDA:0 (NVIDIA A100-SXM4-40GB, 40514MiB)\n","\n","Fusing layers... \n","Model summary: 212 layers, 20877180 parameters, 0 gradients\n","Adding AutoShape... \n"]}]},{"cell_type":"code","source":["import torch\n","import time\n","\n","weights_path = 'runs/train/yolov5_medium2/weights/best.pt'\n","\n","model = torch.hub.load('.', 'custom', path=weights_path, source='local')\n","\n","#warm up run\n","# Load a dummy image\n","dummy_image = torch.randn((1, 3, 224, 224))\n","model(dummy_image)\n","\n","total_inference_time = 0\n","\n","# Loop through the images\n","for image in images:\n","    # Start time recording\n","    start_time = time.time()\n","\n","    # Inference\n","    results = model(image)\n","\n","    # End time recording\n","    end_time = time.time()\n","\n","    # Calculating the inference time\n","    inference_time = end_time - start_time\n","    total_inference_time += inference_time\n","\n","    #print(f\"Inference Time for {image}: {inference_time} seconds\")\n","\n","# Calculating average inference time\n","average_inference_time = total_inference_time / len(images)\n","\n","# Calculating average frames per second (FPS)\n","average_fps = 1 / average_inference_time\n","\n","print(f\"Average Inference Time: {average_inference_time} seconds\")\n","print(f\"Average FPS: {average_fps}\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WxuliJ0eVVNt","executionInfo":{"status":"ok","timestamp":1692891474017,"user_tz":-330,"elapsed":13765,"user":{"displayName":"Santhosh Thundipadath","userId":"08310988276359706879"}},"outputId":"19a6c048-58a6-43e6-9fcc-a2687365dee0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["YOLOv5 🚀 v7.0-198-g34c2187 Python-3.10.12 torch-2.0.1+cu118 CUDA:0 (NVIDIA A100-SXM4-40GB, 40514MiB)\n","\n","Fusing layers... \n","Model summary: 212 layers, 20877180 parameters, 0 gradients\n","Adding AutoShape... \n"]},{"output_type":"stream","name":"stdout","text":["Average Inference Time: 0.01159563740306997 seconds\n","Average FPS: 86.23932995138739\n"]}]},{"cell_type":"code","source":["results = model('../../dataset/kitti/test/images/000669.png')\n","\n","results.show()  # or .show(), .save(), .crop(), .pandas(), etc.\n","results.xyxy[0]  # im predictions (tensor)"],"metadata":{"id":"8ne7QVAxjgvg"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1e90WOi2ITt19ap8DNim5z6kItS82IFEN","timestamp":1692718804312},{"file_id":"1oGhMBryIItYBavATMNAeHbHQQ6pqUiFp","timestamp":1692594039492},{"file_id":"1ALRFgUwvCfZsFN-KYESHaljirhi5HF0l","timestamp":1692556110236},{"file_id":"1pwRc1fQPDv3yQSftI5nqDL1XB4GXY-Lw","timestamp":1692548990410},{"file_id":"1CsY4K2DugpgWrSXbJpp7BsJGKe8jg_PH","timestamp":1691424622871},{"file_id":"1gDZ2xcTOgR39tGGs-EZ6i3RTs16wmzZQ","timestamp":1689672725208},{"file_id":"https://github.com/ultralytics/yolov5/blob/master/tutorial.ipynb","timestamp":1591755516488}],"toc_visible":true,"gpuType":"A100"},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}